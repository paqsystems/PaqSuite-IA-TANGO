/*
  Seed idempotente de dbo.PQ_MENUS
  Fuente: PQ_MENUS.seed.v2.json (derivado del bosquejo Excel)
  Orden: recalculado determinísticamente por (parent, id) => order 0..n por cada parent
  Estrategia: MERGE por [id]. Actualiza campos y crea faltantes.
*/

SET NOCOUNT ON;

WITH SourceData AS (
  SELECT *
  FROM (VALUES
    (10000, N'ventas', 0, 0, 0, 0, NULL, NULL),
    (19000, N'Pedidos web', 0, 0, 1, 0, NULL, NULL),
    (20000, N'Stock', 0, 0, 2, 0, NULL, NULL),
    (30000, N'Proveedores', 0, 0, 3, 0, NULL, NULL),
    (40000, N'Compras', 0, 0, 4, 0, NULL, NULL),
    (50000, N'Tesoreria', 0, 0, 5, 0, NULL, NULL),
    (60000, N'Sueldos', 0, 0, 6, 0, NULL, NULL),
    (70000, N'Contabilidad', 0, 0, 7, 0, NULL, NULL),
    (80000, N'Logistica', 0, 0, 8, 0, NULL, NULL),
    (90000, N'Producción', 0, 0, 9, 0, NULL, NULL),
    (100000, N'Administración', 0, 0, 10, 0, NULL, NULL),
    (110000, N'Activos Fijos', 0, 0, 11, 0, NULL, NULL),
    (120000, N'Tableros de Control', 0, 0, 12, 0, NULL, NULL),
    (10100, N'Archivos', 0, 10000, 0, 0, NULL, NULL),
    (10200, N'Pedidos', 0, 10000, 1, 0, NULL, NULL),
    (10300, N'Facturación', 0, 10000, 2, 0, NULL, NULL),
    (10400, N'Cuenta Corriente', 0, 10000, 3, 0, NULL, NULL),
    (10500, N'Informes', 0, 10000, 4, 0, NULL, NULL),
    (10800, N'Acopios', 0, 10000, 5, 0, NULL, NULL),
    (10900, N'Consultas Personalizadas', 0, 10000, 6, 0, NULL, NULL),
    (10105, N'Clientes', 0, 10100, 0, 0, N'vt_archivos_cliente', NULL),
    (10110, N'Alicuotas', 0, 10100, 1, 0, N'vt_archivos_alicuota', NULL),
    (10115, N'Vendedores', 0, 10100, 2, 0, N'vt_archivos_vendedor', NULL),
    (10120, N'Transportes', 0, 10100, 3, 0, N'vt_archivos_transporte', NULL),
    (10125, N'Zonas', 0, 10100, 4, 0, N'vt_archivos_zona', NULL),
    (10130, N'Condiciones Venta', 0, 10100, 5, 0, N'vt_archivos_condicionventa', NULL),
    (10135, N'Actividades Ingresos Brutos', 0, 10100, 6, 0, N'vt_archivos_actividad', NULL),
    (10140, N'codigos Retenciones', 0, 10100, 7, 0, N'vt_archivos_retencion', NULL),
    (10145, N'Tipos Comprobantes', 0, 10100, 8, 0, N'vt_archivos_comprobante', NULL),
    (10150, N'Talonarios', 0, 10100, 9, 0, N'vt_artchivos_talonario', NULL),
    (10310, N'Facturación Mostrador', 0, 10300, 0, 0, N'vt_facturar_mostrador', NULL),
    (10320, N'Facturación General', 0, 10300, 1, 0, N'vt_facturar_general', NULL),
    (10330, N'Obtención CAEs', 0, 10300, 2, 0, NULL, NULL),
    (10340, N'Reemplazar Numeración', 0, 10300, 3, 0, NULL, NULL),
    (10410, N'Cobranzas', 0, 10400, 0, 0, NULL, NULL),
    (10510, N'Iva Ventas', 0, 10500, 0, 0, N'vt_informes_ivaventas', NULL),
    (10520, N'Ventas para SIFERE', 0, 10500, 1, 0, N'vt_informes_sifere', NULL),
    (10530, N'Impuestos de Ventas', 0, 10500, 2, 0, N'vt_informes_impuestos', NULL),
    (10810, N'Definir Facturas', 0, 10800, 0, 0, N'vta_acopios_facturas', NULL),
    (10820, N'Asignar Pedidos', 0, 10800, 1, 0, N'vta_acopios_pedidos', NULL),
    (10830, N'Informe Acopios', 0, 10800, 2, 0, N'vta_acopios_informes', NULL),
    (10901, N'2da Unidad Medida', 0, 10900, 0, 0, N'ventas_consultas_2daunidad', NULL),
    (10902, N'Pedidos', 0, 10900, 1, 0, N'robinet_pedidos', NULL),
    (10903, N'Cobranzas', 0, 10900, 2, 0, N'robinet_cobranzas', NULL),
    (10904, N'Deuda', 0, 10900, 3, 0, N'composicion_saldos', NULL),
    (19010, N'Carga Pedidos', 0, 19000, 0, 0, N'pw_cargapedidos', NULL),
    (19020, N'Presupuestos Ingresados', 0, 19000, 1, 0, N'pw_presupuestosingresados', NULL),
    (19030, N'Pedidos Ingresados', 0, 19000, 2, 0, N'pw_pedidosingresados', NULL),
    (19040, N'Pedidos Pendientes', 0, 19000, 3, 0, N'pw_pedidospendientes', NULL),
    (19050, N'Deuda de Clientes', 0, 19000, 4, 0, N'pw_deudaclientes', NULL),
    (19060, N'Historial de Ventas', 0, 19000, 5, 0, N'pw_historialventas', NULL),
    (19070, N'Consulta Cheques', 0, 19000, 6, 0, N'pw_consultacheques', NULL),
    (19080, N'Consulta Stock', 0, 19000, 7, 0, N'pw_consultastock', NULL),
    (20100, N'Archivos', 0, 20000, 0, 0, NULL, NULL),
    (20300, N'Movimientos Stock', 0, 20000, 1, 0, NULL, NULL),
    (20500, N'Informes', 0, 20000, 2, 0, NULL, NULL),
    (20105, N'Depositos', 0, 20100, 0, 0, N'st_archivos_deposito', NULL),
    (20110, N'Tipos Comprobantes', 0, 20100, 1, 0, N'st_archivos_comprobante', NULL),
    (20115, N'Talonarios', 0, 20100, 2, 0, N'st_archivos_talonario', NULL),
    (20510, N'Movimientos Articulos', 0, 20500, 0, 0, N'st_informes_mayor', NULL),
    (20520, N'Movimientos Articulos-Depósito', 0, 20500, 1, 0, N'st_informe_mayordeposito', NULL),
    (20530, N'Listado de Saldos', 0, 20500, 2, 0, N'st_informes_saldos', NULL),
    (20540, N'Stock Valorizado', 0, 20500, 3, 0, N'st_informes_saldosvalorizado', NULL),
    (20550, N'Stock para Inventariar', 0, 20500, 4, 0, N'st_informes_auditoria', NULL),
    (40100, N'Archivos', 0, 40000, 0, 0, NULL, NULL),
    (40200, N'Ordenes de Compra', 0, 40000, 1, 0, NULL, NULL),
    (40300, N'Facturación', 0, 40000, 2, 0, NULL, NULL),
    (40400, N'Cuenta Corriente', 0, 40000, 3, 0, NULL, NULL),
    (40500, N'Informes', 0, 40000, 4, 0, NULL, NULL),
    (40105, N'Proveedores', 0, 40100, 0, 0, N'cp_archivos_proveedor', NULL),
    (40110, N'Compradores', 0, 40100, 1, 0, N'cp_archivos_comprador', NULL),
    (40115, N'Alicuotas', 0, 40100, 2, 0, N'cp_archivos_alicuota', NULL),
    (40120, N'Conceptos Compra', 0, 40100, 3, 0, N'cp_archivos_concepto', NULL),
    (40125, N'Condiciones Compra', 0, 40100, 4, 0, N'cp_archivos_condicioncompra', NULL),
    (40130, N'Retenciones', 0, 40100, 5, 0, N'cp_archivos_retención', NULL),
    (40135, N'Tipos Comprobantes', 0, 40100, 6, 0, N'cp_archivos_comprobante', NULL),
    (40310, N'Comprobantes desde AFIP', 0, 40300, 0, 0, N'cp_facturar_AFIP', NULL),
    (40320, N'Facturas sobre Remito', 0, 40300, 1, 0, N'cp_facturar_remito', NULL),
    (40330, N'Facturación Compras', 0, 40300, 2, 0, N'cp_compras_general', NULL),
    (40340, N'Facturación Gastos', 0, 40300, 3, 0, N'cp_gastos_general', NULL),
    (40410, N'Pagos a Proveedores', 0, 40400, 0, 0, N'cp_procesos_pagos', NULL),
    (40420, N'Imputacion Comprobantes', 0, 40400, 1, 0, N'cp_procesos_imputaciones', NULL),
    (40430, N'Avisos Comprobantes AFIP', 0, 40400, 2, 0, N'cp_procesos_avisos', NULL),
    (40510, N'Iva Compras', 0, 40500, 0, 0, N'cp_informes_ivacompras', NULL),
    (40520, N'Impuestos de Compras', 0, 40500, 1, 0, N'cp_informes_impuestos', NULL),
    (40530, N'Resulmen de Compras', 0, 40500, 2, 0, N'cp_informes_resumencuenta', NULL),
    (40540, N'Composición de Saldos', 0, 40500, 3, 0, N'cp_informes_composiciónsaldos', NULL),
    (40550, N'Listado de saldos', 0, 40500, 4, 0, N'cp_informes_listadosaldos', NULL),
    (50100, N'Archivos', 0, 50000, 0, 0, NULL, NULL),
    (50300, N'Movimientos', 0, 50000, 1, 0, NULL, NULL),
    (50500, N'Informes', 0, 50000, 2, 0, NULL, NULL),
    (50105, N'Cuentas', 0, 50100, 0, 0, N'sb_archivos_cuenta', NULL),
    (50110, N'Tipos Comprobantes', 0, 50100, 1, 0, N'sb_archivos_comprobante', NULL),
    (50115, N'Talonarios', 0, 50100, 2, 0, N'sb_archivos_talonario', NULL),
    (50120, N'Chequeras', 0, 50100, 3, 0, N'sb_archivos_chequera', NULL),
    (50125, N'Tarjetas', 0, 50100, 4, 0, N'sb_archivos_tarjeta', NULL),
    (50510, N'Movimientos de Cuentas', 0, 50500, 0, 0, N'sb_informes_mayor', NULL),
    (50520, N'Listado de saldos', 0, 50500, 1, 0, N'sb_informes_saldos', NULL),
    (50530, N'Cheques en Cartera', 0, 50500, 2, 0, N'sb_informes_chequescartera', NULL),
    (50540, N'Cheques Propios', 0, 50500, 3, 0, N'sb_informes_chequespropios', NULL),
    (90100, N'Gestión de Partes', 0, 90000, 0, 0, NULL, NULL),
    (90110, N'Mantenimiento', 0, 90100, 0, 0, NULL, NULL),
    (90111, N'Análisis Multidimensiona', 0, 90100, 1, 0, NULL, NULL),
    (90120, N'Asignación de Tareas', 0, 90100, 2, 0, NULL, NULL),
    (90130, N'Carga de Tareas', 0, 90100, 3, 0, NULL, NULL),
    (90140, N'Reporte de Tareas', 0, 90100, 4, 0, NULL, NULL),
    (90112, N'Am Tipo de Tarea', 0, 90110, 0, 0, NULL, NULL),
    (90113, N'Am Conceptos', 0, 90110, 1, 0, NULL, NULL),
    (100010, N'Parámetros Generales', 0, 100000, 0, 0, N'pg_cargaparametros', NULL),
    (100100, N'Gestión de Partes de Tareas', 0, 100000, 1, 0, NULL, NULL),
    (100200, N'Seguridad', 0, 100000, 2, 0, NULL, NULL),
    (100300, N'Grupo de Empresas', 0, 100000, 3, 0, NULL, NULL),
    (100400, N'SoporteTecnico', 0, 100000, 4, 0, NULL, NULL),
    (100101, N'Asistentes', 0, 100100, 0, 0, N'partes_asistentes', NULL),
    (100102, N'Clientes', 0, 100100, 1, 0, N'partes_clientes', NULL),
    (100103, N'Partes', 0, 100100, 2, 0, N'partes_partes', NULL),
    (100104, N'Auditoria', 0, 100100, 3, 0, N'partes_auditoria', NULL),
    (100105, N'Consulta', 0, 100100, 4, 0, N'partes_consulta', NULL),
    (100201, N'Usuarios', 0, 100200, 0, 0, N'seguridad_usuarios', NULL),
    (100202, N'Roles', 0, 100200, 1, 0, N'seguridad_roles', NULL),
    (100203, N'Permisos', 0, 100200, 2, 0, N'seguridad_permisos', NULL),
    (100204, N'Empresas', 0, 100200, 3, 0, N'seguridad_empresas', NULL),
    (100310, N'ABM Grupos Empresas', 0, 100300, 0, 0, N'grupo_empresario_abm', NULL),
    (100410, N'Armado de Pantallas', 0, 100400, 0, 0, NULL, N'armadopantallas'),
    (100420, N'Armado de SpTablas', 0, 100400, 1, 0, NULL, N'armadosptablas'),
    (100430, N'Armado de SqlComandos', 0, 100400, 2, 0, NULL, N'armadosqlcomandos'),
    (120100, N'(golo Tap)', 0, 120000, 0, 0, NULL, NULL),
    (120110, N'Resultado Económico', 0, 120100, 0, 0, N'golo_resultadoeconomico', NULL),
    (120120, N'ingresos', 0, 120100, 1, 0, N'golo_ingresos', NULL),
    (120130, N'Costos', 0, 120100, 2, 0, N'golo_costos', NULL),
    (120140, N'Gastos', 0, 120100, 3, 0, N'golo_gastos', NULL),
    (120150, N'Sueldos', 0, 120100, 4, 0, N'golo_sueldos', NULL),
    (120160, N'Saldos Pendientes', 0, 120100, 5, 0, N'golo_saldospendientes', NULL)
  ) AS v([id],[text],[expanded],[parent],[order],[enabled],[procedimiento],[routeName])
)
MERGE dbo.PQ_MENUS AS T
USING SourceData AS S
  ON T.[id] = S.[id]
WHEN MATCHED THEN
  UPDATE SET
    T.[text] = S.[text],
    T.[expanded] = S.[expanded],
    T.[parent] = S.[parent],
    T.[order] = S.[order],
    T.[enabled] = S.[enabled],
    T.[procedimiento] = S.[procedimiento],
    T.[routeName] = S.[routeName]
WHEN NOT MATCHED BY TARGET THEN
  INSERT ([id],[text],[expanded],[parent],[order],[enabled],[procedimiento],[routeName])
  VALUES (S.[id],S.[text],S.[expanded],S.[parent],S.[order],S.[enabled],S.[procedimiento],S.[routeName])
;

PRINT 'Seed dbo.PQ_MENUS aplicado OK';
